{% extends "base.html" %}

{% block title %}Edit Profile - SociaFam{% endblock %}

{% block extra_css %}
<style>
    .edit-profile-container {
        max-width: 800px;
        margin: 0 auto;
    }
    
    .edit-profile-header {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        padding: 20px;
        margin-bottom: 20px;
    }
    
    .edit-profile-title {
        font-size: 24px;
        font-weight: 600;
        margin-bottom: 20px;
    }
    
    .edit-profile-form {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        padding: 20px;
    }
    
    .edit-profile-section {
        margin-bottom: 30px;
    }
    
    .edit-profile-section-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #e4e6eb;
    }
    
    .form-row {
        display: flex;
        gap: 15px;
        margin-bottom: 15px;
    }
    
    .form-group {
        flex: 1;
        margin-bottom: 15px;
    }
    
    .form-label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
    }
    
    .form-control {
        width: 100%;
        padding: 10px;
        border: 1px solid #dddfe2;
        border-radius: 6px;
        font-size: 16px;
    }
    
    .form-select {
        width: 100%;
        padding: 10px;
        border: 1px solid #dddfe2;
        border-radius: 6px;
        font-size: 16px;
        background-color: white;
    }
    
    .form-textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #dddfe2;
        border-radius: 6px;
        font-size: 16px;
        resize: vertical;
        min-height: 100px;
    }
    
    .form-help {
        font-size: 14px;
        color: #65676b;
        margin-top: 5px;
    }
    
    .avatar-upload {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 20px;
    }
    
    .avatar-preview {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        overflow: hidden;
    }
    
    .avatar-preview img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .avatar-upload-btn {
        padding: 10px 15px;
        background-color: #e4e6eb;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
    }
    
    .form-submit {
        text-align: right;
        margin-top: 20px;
    }
    
    .form-submit button {
        padding: 10px 20px;
        background-color: #1877f2;
        color: white;
        border: none;
        border-radius: 6px;
        font-weight: 600;
        cursor: pointer;
    }
</style>
{% endblock %}

{% block content %}
<div class="edit-profile-container">
    <div class="edit-profile-header">
        <h1 class="edit-profile-title">Edit Profile</h1>
    </div>
    
    <form class="edit-profile-form" method="POST" action="{{ url_for('edit_profile') }}" enctype="multipart/form-data">
        <div class="edit-profile-section">
            <h2 class="edit-profile-section-title">Profile Photo</h2>
            
            <div class="avatar-upload">
                <div class="avatar-preview">
                    <img src="{{ url_for('get_profile_image', user_id=current_user.id) }}" alt="{{ current_user.username }}" id="profilePicPreview">
                </div>
                
                <div>
                    <input type="file" id="profilePic" name="profile_pic" accept="image/*" style="display: none;">
                    <label for="profilePic" class="avatar-upload-btn">Upload Photo</label>
                    <div class="form-help">Recommended: 400x400 pixels, JPG, PNG or GIF</div>
                </div>
            </div>
        </div>
        
        <div class="edit-profile-section">
            <h2 class="edit-profile-section-title">Basic Information</h2>
            
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label" for="real_name">Real Name</label>
                    <input type="text" class="form-control" id="real_name" name="real_name" value="{{ current_user.real_name or '' }}">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="username">Username</label>
                    <input type="text" class="form-control" id="username" name="username" value="{{ current_user.username }}" disabled>
                    <div class="form-help">Username cannot be changed</div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="bio">Bio</label>
                <textarea class="form-textarea" id="bio" name="bio" placeholder="Tell people about yourself">{{ current_user.bio or '' }}</textarea>
                <div class="form-help">You can mention other users with @username</div>
            </div>
        </div>
        
        <div class="edit-profile-section">
            <h2 class="edit-profile-section-title">Work and Education</h2>
            
            <div class="form-group">
                <label class="form-label" for="work">Work</label>
                <input type="text" class="form-control" id="work" name="work" value="{{ current_user.work or '' }}" placeholder="Where do you work?">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="university">University</label>
                <input type="text" class="form-control" id="university" name="university" value="{{ current_user.university or '' }}" placeholder="Where did you go to university?">
            </div>
        </div>
        
        <div class="edit-profile-section">
            <h2 class="edit-profile-section-title">Contact Information</h2>
            
            <div class="form-group">
                <label class="form-label" for="location">Location</label>
                <input type="text" class="form-control" id="location" name="location" value="{{ current_user.location or '' }}" placeholder="Where do you live?">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="website">Website</label>
                <input type="url" class="form-control" id="website" name="website" value="{{ current_user.website or '' }}" placeholder="Your website URL">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="phone_number">Phone Number</label>
                <input type="tel" class="form-control" id="phone_number" name="phone_number" value="{{ current_user.phone_number or '' }}" placeholder="Your phone number">
            </div>
        </div>
        
        <div class="form-submit">
            <button type="submit">Save Changes</button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Handle profile picture preview
    const profilePicInput = document.getElementById('profilePic');
    const profilePicPreview = document.getElementById('profilePicPreview');
    
    if (profilePicInput && profilePicPreview) {
        profilePicInput.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    profilePicPreview.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        });
    }
</script>
{% endblock %}
