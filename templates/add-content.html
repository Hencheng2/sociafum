{% extends "base.html" %}

{% block title %}Add Content - SociaFam{% endblock %}

{% block extra_css %}
<style>
    .add-content-container {
        max-width: 600px;
        margin: 0 auto;
    }
    
    .add-content-header {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        padding: 20px;
        margin-bottom: 20px;
        text-align: center;
    }
    
    .add-content-title {
        font-size: 24px;
        font-weight: 600;
        margin-bottom: 20px;
    }
    
    .add-content-types {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .add-content-type {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        border: 2px solid #e4e6eb;
        border-radius: 8px;
        cursor: pointer;
        transition: border-color 0.3s;
    }
    
    .add-content-type.active {
        border-color: #1877f2;
    }
    
    .add-content-type i {
        font-size: 32px;
        margin-bottom: 10px;
        color: #65676b;
    }
    
    .add-content-type.active i {
        color: #1877f2;
    }
    
    .add-content-type-name {
        font-weight: 600;
    }
    
    .add-content-form {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        padding: 20px;
    }
    
    .add-content-preview {
        margin-bottom: 20px;
        text-align: center;
    }
    
    .add-content-preview img,
    .add-content-preview video {
        max-width: 100%;
        max-height: 400px;
        border-radius: 8px;
    }
    
    .add-content-upload {
        text-align: center;
        margin-bottom: 20px;
        padding: 40px;
        border: 2px dashed #dddfe2;
        border-radius: 8px;
        cursor: pointer;
    }
    
    .add-content-upload i {
        font-size: 48px;
        color: #65676b;
        margin-bottom: 15px;
    }
    
    .add-content-upload p {
        color: #65676b;
        margin-bottom: 15px;
    }
    
    .add-content-text {
        margin-bottom: 20px;
    }
    
    .add-content-text textarea {
        width: 100%;
        padding: 15px;
        border: 1px solid #dddfe2;
        border-radius: 8px;
        font-size: 16px;
        resize: vertical;
        min-height: 100px;
    }
    
    .add-content-audience {
        margin-bottom: 20px;
    }
    
    .add-content-audience select {
        width: 100%;
        padding: 10px;
        border: 1px solid #dddfe2;
        border-radius: 6px;
        font-size: 16px;
        background-color: white;
    }
    
    .add-content-submit {
        text-align: center;
    }
    
    .add-content-submit button {
        padding: 12px 30px;
        background-color: #1877f2;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
    }
    
    .add-content-hidden {
        display: none;
    }
</style>
{% endblock %}

{% block content %}
<div class="add-content-container">
    <div class="add-content-header">
        <h1 class="add-content-title">Create New Post</h1>
        
        <div class="add-content-types">
            <div class="add-content-type active" data-type="post">
                <i class="fas fa-image"></i>
                <div class="add-content-type-name">Post</div>
            </div>
            
            <div class="add-content-type" data-type="reel">
                <i class="fas fa-film"></i>
                <div class="add-content-type-name">Reel</div>
            </div>
            
            <div class="add-content-type" data-type="story">
                <i class="fas fa-circle"></i>
                <div class="add-content-type-name">Story</div>
            </div>
        </div>
    </div>
    
    <form class="add-content-form" method="POST" action="{{ url_for('add_post') }}" enctype="multipart/form-data">
        <input type="hidden" name="type" id="contentType" value="post">
        
        <div class="add-content-preview" id="mediaPreview">
            <div class="add-content-upload" id="mediaUpload">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>Click to upload or drag and drop</p>
                <p>PNG, JPG, GIF up to 10MB</p>
                <input type="file" id="mediaInput" name="media" accept="image/*,video/*" style="display: none;">
            </div>
        </div>
        
        <div class="add-content-text">
            <textarea name="content" placeholder="Write a caption..."></textarea>
        </div>
        
        <div class="add-content-audience">
            <select name="audience">
                <option value="public">Public</option>
                <option value="friends">Friends Only</option>
                <option value="private">Only Me</option>
            </select>
        </div>
        
        <div class="add-content-submit">
            <button type="submit">Share</button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Handle content type selection
    document.querySelectorAll('.add-content-type').forEach(type => {
        type.addEventListener('click', function() {
            // Remove active class from all types
            document.querySelectorAll('.add-content-type').forEach(t => t.classList.remove('active'));
            
            // Add active class to clicked type
            this.classList.add('active');
            
            // Update hidden input value
            document.getElementById('contentType').value = this.dataset.type;
            
            // Update upload text based on type
            const uploadArea = document.getElementById('mediaUpload');
            if (this.dataset.type === 'post') {
                uploadArea.innerHTML = `
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Click to upload or drag and drop</p>
                    <p>PNG, JPG, GIF up to 10MB</p>
                `;
                document.getElementById('mediaInput').accept = "image/*,video/*";
            } else if (this.dataset.type === 'reel') {
                uploadArea.innerHTML = `
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Click to upload or drag and drop</p>
                    <p>MP4, MOV up to 100MB</p>
                `;
                document.getElementById('mediaInput').accept = "video/*";
            } else if (this.dataset.type === 'story') {
                uploadArea.innerHTML = `
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Click to upload or drag and drop</p>
                    <p>PNG, JPG, GIF, MP4 up to 15MB</p>
                `;
                document.getElementById('mediaInput').accept = "image/*,video/*";
            }
            
            // Add the file input back
            uploadArea.appendChild(document.getElementById('mediaInput'));
        });
    });
    
    // Handle media upload preview
    const mediaInput = document.getElementById('mediaInput');
    const mediaPreview = document.getElementById('mediaPreview');
    
    if (mediaInput && mediaPreview) {
        mediaInput.addEventListener('change', function() {
            const file = this.files[0];
            if (file) {
                const url = URL.createObjectURL(file);
                
                if (file.type.startsWith('image/')) {
                    mediaPreview.innerHTML = `<img src="${url}" alt="Preview">`;
                } else if (file.type.startsWith('video/')) {
                    mediaPreview.innerHTML = `<video src="${url}" controls></video>`;
                }
            }
        });
        
        // Enable drag and drop
        mediaPreview.addEventListener('dragover', function(e) {
            e.preventDefault();
            this.style.borderColor = '#1877f2';
        });
        
        mediaPreview.addEventListener('dragleave', function() {
            this.style.borderColor = '#dddfe2';
        });
        
        mediaPreview.addEventListener('drop', function(e) {
            e.preventDefault();
            this.style.borderColor = '#dddfe2';
            
            const file = e.dataTransfer.files[0];
            if (file) {
                mediaInput.files = e.dataTransfer.files;
                
                const url = URL.createObjectURL(file);
                if (file.type.startsWith('image/')) {
                    mediaPreview.innerHTML = `<img src="${url}" alt="Preview">`;
                } else if (file.type.startsWith('video/')) {
                    mediaPreview.innerHTML = `<video src="${url}" controls></video>`;
                }
            }
        });
    }
</script>
{% endblock %}
